#!/usr/bin/env python3

__author__ = "Altertech Group, https://www.altertech.com/"
__copyright__ = "Copyright (C) 2012-2018 Altertech Group"
__license__ = "https://www.eva-ics.com/license"
__version__ = "3.1.0"

import sys
import jinja2

def usage():
    print("""
    Usage: test_tpl <template_file> [config]
    
        template_file           template file to test
        config                  config params, comma sparated
                                name=value pairs
    """)
    sys.exit(99)

try:
    tpl_file = sys.argv[1]
except:
    usage()

try:
    c = sys.argv[2].split(',')
except:
    c = []

config = {}

for i in c:
    try:
        name, value = i.split('=')
        config[name] = value
    except:
        usage()

try:
    template = jinja2.Template(open(tpl_file).read())
except:
    usage()

print(template.render(config))
